<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>HTTPS访问 | Metabase 镜像手册</title>
    <meta name="description" content="You can get the Installation of Image,Administrator,Configuration of the OwnCloud from this documentation.">
    <link rel="icon" href="/docs/metabase/favcon.ico">
    
    <link rel="preload" href="/docs/metabase/assets/css/0.styles.bc5b6c05.css" as="style"><link rel="preload" href="/docs/metabase/assets/js/app.7d98e053.js" as="script"><link rel="preload" href="/docs/metabase/assets/js/2.a9bd2ee6.js" as="script"><link rel="preload" href="/docs/metabase/assets/js/30.215eb085.js" as="script"><link rel="prefetch" href="/docs/metabase/assets/js/10.7592c793.js"><link rel="prefetch" href="/docs/metabase/assets/js/11.9a78f6f3.js"><link rel="prefetch" href="/docs/metabase/assets/js/12.59b81fbe.js"><link rel="prefetch" href="/docs/metabase/assets/js/13.24e47bb4.js"><link rel="prefetch" href="/docs/metabase/assets/js/14.697b42ce.js"><link rel="prefetch" href="/docs/metabase/assets/js/15.ec191011.js"><link rel="prefetch" href="/docs/metabase/assets/js/16.23df9444.js"><link rel="prefetch" href="/docs/metabase/assets/js/17.b74d8aa3.js"><link rel="prefetch" href="/docs/metabase/assets/js/18.a6534a26.js"><link rel="prefetch" href="/docs/metabase/assets/js/19.ae96e059.js"><link rel="prefetch" href="/docs/metabase/assets/js/20.1b21b34a.js"><link rel="prefetch" href="/docs/metabase/assets/js/21.9444569e.js"><link rel="prefetch" href="/docs/metabase/assets/js/22.a54dda7a.js"><link rel="prefetch" href="/docs/metabase/assets/js/23.6b90f36c.js"><link rel="prefetch" href="/docs/metabase/assets/js/24.35d2cbc0.js"><link rel="prefetch" href="/docs/metabase/assets/js/25.da3ca512.js"><link rel="prefetch" href="/docs/metabase/assets/js/26.60a9a2a7.js"><link rel="prefetch" href="/docs/metabase/assets/js/27.97b39b04.js"><link rel="prefetch" href="/docs/metabase/assets/js/28.453ce9d6.js"><link rel="prefetch" href="/docs/metabase/assets/js/29.a58c23f7.js"><link rel="prefetch" href="/docs/metabase/assets/js/3.a6d829c5.js"><link rel="prefetch" href="/docs/metabase/assets/js/31.830609b9.js"><link rel="prefetch" href="/docs/metabase/assets/js/32.0e1e8207.js"><link rel="prefetch" href="/docs/metabase/assets/js/33.474bc23f.js"><link rel="prefetch" href="/docs/metabase/assets/js/34.e70b217f.js"><link rel="prefetch" href="/docs/metabase/assets/js/35.49ca8d59.js"><link rel="prefetch" href="/docs/metabase/assets/js/36.59d2e240.js"><link rel="prefetch" href="/docs/metabase/assets/js/37.a16a9557.js"><link rel="prefetch" href="/docs/metabase/assets/js/38.4812ab63.js"><link rel="prefetch" href="/docs/metabase/assets/js/39.60d3bcd5.js"><link rel="prefetch" href="/docs/metabase/assets/js/4.b72cfc44.js"><link rel="prefetch" href="/docs/metabase/assets/js/5.60135ff5.js"><link rel="prefetch" href="/docs/metabase/assets/js/6.d0e55720.js"><link rel="prefetch" href="/docs/metabase/assets/js/7.c84a7146.js"><link rel="prefetch" href="/docs/metabase/assets/js/8.29a0441c.js"><link rel="prefetch" href="/docs/metabase/assets/js/9.b86d418f.js">
    <link rel="stylesheet" href="/docs/metabase/assets/css/0.styles.bc5b6c05.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/docs/metabase/zh/" class="home-link router-link-active"><!----> <span class="site-name">Metabase 镜像手册</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/docs/metabase/zh/" class="nav-link">首页</a></div><div class="nav-item"><a href="http://support.websoft9.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  支持
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/metabase/solution-https.html" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/docs/metabase/zh/solution-https.html" class="nav-link router-link-exact-active router-link-active">中文</a></li></ul></div></div> <a href="https://github.com/Websoft9/ansible-metabase" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/docs/metabase/zh/" class="nav-link">首页</a></div><div class="nav-item"><a href="http://support.websoft9.com/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  支持
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/docs/metabase/solution-https.html" class="nav-link">English</a></li><li class="dropdown-item"><!----> <a href="/docs/metabase/zh/solution-https.html" class="nav-link router-link-exact-active router-link-active">中文</a></li></ul></div></div> <a href="https://github.com/Websoft9/ansible-metabase" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>开始</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/metabase/zh/" class="sidebar-link">关于</a></li><li><a href="/docs/metabase/zh/stack-deployment.html" class="sidebar-link">部署</a></li><li><a href="/docs/metabase/zh/stack-installation.html" class="sidebar-link">初始化安装</a></li><li><a href="/docs/metabase/zh/stack-components.html" class="sidebar-link">参数</a></li><li><a href="/docs/metabase/zh/stack-accounts.html" class="sidebar-link">账号密码</a></li><li><a href="/docs/metabase/zh/cloud-server.html" class="sidebar-link">服务器入门</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>最佳实践</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/metabase/zh/solution-smtp.html" class="sidebar-link">SMTP发送邮件</a></li><li><a href="/docs/metabase/zh/solution-https.html" class="active sidebar-link">HTTPS访问</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/docs/metabase/zh/solution-https.html#configuration-method-1-using-your-own-certificate" class="sidebar-link">Configuration Method 1: Using your own certificate</a></li><li class="sidebar-sub-header"><a href="/docs/metabase/zh/solution-https.html#configuration-method-2-using-let-s-encrypt" class="sidebar-link">Configuration Method 2: Using Let's Encrypt</a></li><li class="sidebar-sub-header"><a href="/docs/metabase/zh/solution-https.html#faq" class="sidebar-link">FAQ</a></li></ul></li><li><a href="/docs/metabase/zh/solution-dns.html" class="sidebar-link">绑定域名</a></li><li><a href="/docs/metabase/zh/solution-backup.html" class="sidebar-link">备份与恢复</a></li><li><a href="/docs/metabase/zh/solution-upgrade.html" class="sidebar-link">升级</a></li><li><a href="/docs/metabase/zh/solution-migration.html" class="sidebar-link">迁移</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>管理指南</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/metabase/zh/admin-services.html" class="sidebar-link">服务启停</a></li><li><a href="/docs/metabase/zh/admin-mysql.html" class="sidebar-link">数据库</a></li><li><a href="/docs/metabase/zh/admin-linux.html" class="sidebar-link">系统</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>其他</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/docs/metabase/zh/faq.html" class="sidebar-link">FAQ</a></li><li><a href="/docs/metabase/zh/troubleshooting.html" class="sidebar-link">故障处理</a></li></ul></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="https访问"><a href="#https访问" aria-hidden="true" class="header-anchor">#</a> HTTPS访问</h1> <p>Websoft9 OwnCloud(LAMP) have enabled the Nginx SSL module, you just need to add the HTTPS profile to vhost configuration file .Before setting up HTTPS access, please open port 443 of the security group. if not, HTTPS access is not available.</p> <p>Here are two configuration schemes for HTTPS, please choose according to the actual situation:</p> <p><a name="f7f3b410"></a></p> <h2 id="configuration-method-1-using-your-own-certificate"><a href="#configuration-method-1-using-your-own-certificate" aria-hidden="true" class="header-anchor">#</a> Configuration Method 1: Using your own certificate</h2> <p>If you have already applied for a certificate (please ensure that the certificate is available), please refer to the following configuration:</p> <ol><li>Upload the certificate to the certificate Directory: <em>/data/cert</em> (no cert directory can be created by yourself)</li> <li>Copy the HTTPS profile template below into the <em><code>vhost.conf</code></em> file and save</li></ol> <div class="language-shell extra-class"><pre class="language-text"><code>&lt;VirtualHost *:443&gt;
ServerName  www.mydomain.com
DocumentRoot &quot;/data/wwwroot/owncloud&quot;
#ErrorLog &quot;logs/www.mydomain.com-error_log&quot;
#CustomLog &quot;logs/www.mydomain.com-access_log&quot; common
&lt;Directory &quot;/data/wwwroot/owncloud&quot;&gt;
Options Indexes FollowSymlinks
AllowOverride All
Require all granted
&lt;/Directory&gt;
SSLEngine on
SSLCertificateFile  /data/cert/www.mydomain.com.crt
SSLCertificateKeyFile  /data/cert/www.mydomain.com.key
SSLCertificateChainFile  /data/cert/root_bundle.crt
&lt;/VirtualHost&gt;
</code></pre></div><ol start="3"><li>Modify the related items in the configuration file and save
| <strong>Items</strong> | <strong>Description</strong> |
| --- | --- |
| ServerName | Primary domain |
| DocumentRoot | The real website storage directory |
| Directory | The real website storage directory |
| ErrorLog | error logs directory |
| CustomLog | visit logs directory |
| SSLCertificateFile | SSLCertificateFile directory, suffix name is .crt or .pem |
| SSLCertificateKeyFile  | SSLCertificateKeyFile directory, suffix name is .key |
| SSLCertificateChainFile  | SSLCertificateChainFile  directory, suffix name is .cer |</li></ol> <blockquote><p>The incorrect directory will cause the service to fail to restart, view the ErroLog to troubleshoot</p></blockquote> <ol start="3"><li>Restart HTTP Services</li></ol> <div class="language-shell extra-class"><pre class="language-text"><code>#~ systemctl restart httpd
</code></pre></div><p><a name="f09ba4e3"></a></p> <h2 id="configuration-method-2-using-let-s-encrypt"><a href="#configuration-method-2-using-let-s-encrypt" aria-hidden="true" class="header-anchor">#</a> Configuration Method 2: Using Let's Encrypt</h2> <p>You can use the free SSL/TLS Certificate <a href="https://letsencrypt.org/" target="_blank" rel="noopener noreferrer">Let's Encrypt<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in this Image, Let's Encrypt is a free, automated, and open Certificate Authority.</p> <p>Before using Let's Encrypt Certificate for your site, you should make sure that your site have already bound to the domain name, it's means that the ServerName parameter have correct domain in HTTP profile template.<br>E.g. The domain of your site is test.websoft9.cn, here are the steps to configure the HTTPS:</p> <ol><li>Start up the Let's Encrypt configuration just need one command</li></ol> <div class="language-shell extra-class"><pre class="language-text"><code>certbot
</code></pre></div><ol start="2"><li>Enter the corresponding content according to the prompt</li></ol> <blockquote><p>You can select multiple domain by the method 1,2 when come to the step &quot;Which names would you like to activate HTTPS for?&quot;</p></blockquote> <ol start="3"><li><p>After the above steps are completed, certbot will automatically configure the certificate to the directory <em>/etc/letsencrypt/live/</em></p></li> <li><p>Visit the HTTPS to confirm you have configured successfully</p></li></ol> <hr> <p><a name="FAQ"></a></p> <h2 id="faq"><a href="#faq" aria-hidden="true" class="header-anchor">#</a> FAQ</h2> <p><a name="aa9423d7"></a></p> <h3 id="note-on-the-application-of-the-certificate"><a href="#note-on-the-application-of-the-certificate" aria-hidden="true" class="header-anchor">#</a> Note on the application of the certificate</h3> <ul><li>domain.com is a wildcard domain name method and cannot be used to apply for a free certificate</li> <li>When applying for a certificate, please resolve the domain name first. some certificates will bind the IP address corresponding to the domain name, that is, the IP address cannot be replaced once applied, otherwise the certificate will not be available</li></ul> <p><a name="cb873aa0"></a></p> <h3 id="why-is-the-setup-successful-showing-the-connection-established-with-this-site-is-not-completely-secure"><a href="#why-is-the-setup-successful-showing-the-connection-established-with-this-site-is-not-completely-secure" aria-hidden="true" class="header-anchor">#</a> Why is the setup successful, showing &quot;the connection established with this site is not completely secure &quot;?</h3> <p>If https can be visited, you can make sure that your HTTPS settings are successful, just because there are static files containing http access, or external links, etc. in the website, the browser alarms that your website is not completely safe.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/Websoft9/ansible-metabase/edit/master/docs/zh/solution-https.md" target="_blank" rel="noopener noreferrer">在Github上编辑</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">Last Updated: </span> <span class="time">2019-8-1 13:45:23</span></div></footer> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/docs/metabase/zh/solution-smtp.html" class="prev">
          SMTP发送邮件
        </a></span> <span class="next"><a href="/docs/metabase/zh/solution-dns.html">
          绑定域名
        </a>
        →
      </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/docs/metabase/assets/js/app.7d98e053.js" defer></script><script src="/docs/metabase/assets/js/2.a9bd2ee6.js" defer></script><script src="/docs/metabase/assets/js/30.215eb085.js" defer></script>
  </body>
</html>
